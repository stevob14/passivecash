<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Useful financial calculators including compound interest, inflation adjustment, mortgage payments, and portfolio rebalancing tools from PassiveCash.xyz.">
    <title>Financial Calculators - PassiveCash.xyz</title>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q203YEXP0D"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-Q203YEXP0D');
    </script>
    <link rel="preload" href="style.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="style.css"></noscript>
    <!-- Social Media Meta Tags -->
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.passivecash.xyz/calculators.html">
    <meta property="og:title" content="Financial Calculators - PassiveCash.xyz">
    <meta property="og:description" content="Useful financial calculators including compound interest, inflation adjustment, mortgage payments, and portfolio rebalancing tools from PassiveCash.xyz.">
    <meta property="og:image" content="https://www.passivecash.xyz/images/logo.jpg">
    <meta property="og:site_name" content="PassiveCash.xyz">
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://www.passivecash.xyz/calculators.html">
    <meta name="twitter:title" content="Financial Calculators - PassiveCash.xyz">
    <meta name="twitter:description" content="Useful financial calculators including compound interest, inflation adjustment, mortgage payments, and portfolio rebalancing tools from PassiveCash.xyz.">
    <meta name="twitter:image" content="https://www.passivecash.xyz/images/logo.jpg">
</head>
<body>
    <nav class="navbar">
        <div class="container">
             <a href="index.html" class="logo">PassiveCash.xyz</a>
             <!-- Hamburger Button -->
             <button id="hamburger-btn" aria-label="Toggle Navigation Menu" aria-expanded="false">
                 <span class="bar"></span>
                 <span class="bar"></span>
                 <span class="bar"></span>
             </button>
             <!-- Navigation Links -->
            <ul id="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="calculators.html" class="active">Calculators</a></li>
                <li><a href="crypto.html">Crypto</a></li>
                <li><a href="market.html">Market</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="disclaimer.html">Disclaimer</a></li>
            </ul>
        </div>
    </nav>

    <!-- Advertisement Bar -->
    <div id="advertisement"></div>

    <div class="content-container">

        <div id="calculator-selector-container"> <!-- Renamed container -->
            <!-- Trigger button for mobile -->
            <button id="calculator-menu-trigger" class="calculateBtn">Compound Interest</button>

            <!-- Menu containing the actual buttons -->
            <div id="calculator-menu">
                 <button class="calculateBtn calculator-option" data-target="compound" data-display="Compound Interest">Compound Interest</button>
                 <button class="calculateBtn calculator-option" data-target="rebalancer" data-display="Portfolio Rebalancer">Portfolio Rebalancer</button>
                 <button class="calculateBtn calculator-option" data-target="inflation" data-display="Inflation">Inflation</button>
                 <button class="calculateBtn calculator-option" data-target="mortgage" data-display="Mortgage">Mortgage</button>
            </div>
        </div>

        <!-- Calculators -->
        <div id="compound" class="calculator-section calculator-content"> <!-- Updated ID, removed active -->
            <!-- Removed H2 Title -->
            <div id="compound-interest-calculator">
                <div class="calc-row">
                    <label for="capital">Initial Principal ($):</label>
                    <input type="number" id="capital" value="1000" onkeypress="return isNumberKeyCompound(event)">
                </div>
                <div class="calc-row">
                    <label for="myPercent">Annual Interest Rate (%):</label>
                    <input type="number" id="myPercent" value="5" onkeypress="return isNumberKeyCompound(event)">
                </div>
                <div class="calc-row">
                    <label for="lengthoftime">Investment Duration (Years):</label>
                    <input type="number" id="lengthoftime" value="10" onkeypress="return isNumberKeyCompound(event)">
                </div>
                <div class="calc-row">
                    <label for="contribution">Monthly Contribution/Withdrawal ($):</label>
                    <input type="number" id="contribution" value="100" onkeypress="return allowNegativeNumberCompound(event)">
                    <small>(Enter negative for withdrawal)</small>
                </div>
                <div class="calc-row">
                    <label for="compoundFrequency">Compounding Frequency:</label>
                    <select id="compoundFrequency">
                        <option value="daily">Daily</option>
                        <option value="weekly">Weekly</option>
                        <option value="monthly" selected>Monthly</option>
                        <option value="quarterly">Quarterly</option>
                        <option value="yearly">Annually</option>
                    </select>
                </div>
                <button class="calculateBtn" onclick="calculateCompoundInterest()">Calculate</button>
                <div class="calculator-results">
                     <p id="output"></p> <!-- Changed to single output element -->
                     <!-- Canvas for the chart -->
                     <div style="margin-top: 20px; margin-bottom: 10px; border: 1px solid #444; padding: 10px; background-color: #2a2a2a;">
                        <canvas id="compoundInterestChart"></canvas>
                     </div>
                </div>
                <p>This calculator demonstrates the power of compound interest. Enter your initial investment, interest rate, duration, and any regular contributions to see how your money can grow over time as interest earns interest.</p>
                <p style="margin-top: 10px;">The formula used, including contributions, is:</p>
                <p style="text-align: center; margin: 10px 0; line-height: 1.4;"> <!-- Removed fixed font-size -->
                    <code style="background-color: #2a2a2a; padding: 5px 8px; border: 1px solid #444; border-radius: 3px; overflow-wrap: break-word; word-break: break-all; display: inline-block; max-width: 100%;">
                        A = P(1 + r/n)<sup>nt</sup> + PMT * [((1 + r/n)<sup>nt</sup> - 1) / (r/n)]
                    </code>
                </p>
                <p>Where:</p>
                <ul style="margin-top: 5px; margin-left: 30px; font-size: 0.9em;">
                    <li><b>A</b> = the future value of the investment</li>
                    <li><b>P</b> = the principal investment amount</li>
                    <li><b>PMT</b> = the periodic payment amount (contribution)</li>
                    <li><b>r</b> = the annual interest rate (decimal)</li>
                    <li><b>n</b> = the number of times interest is compounded per year</li>
                    <li><b>t</b> = the time the money is invested for, in years</li>
                </ul>
                <p style="font-size: 0.9em; margin-top: 10px;"><b>Helpful Tips:</b></p>
                <ul style="margin-top: 5px; margin-left: 30px; font-size: 0.9em;">
                    <li><b>Time is your ally:</b> The longer your money is invested, the more significant the effect of compounding.</li>
                    <li><b>Higher rates matter:</b> Even small increases in the annual interest rate can lead to large differences over long periods.</li>
                    <li><b>Frequency helps:</b> More frequent compounding (e.g., daily vs. annually) results in slightly higher returns, though the effect diminishes as frequency increases.</li>
                    <li><b>Contributions accelerate growth:</b> Regular contributions significantly boost the final value compared to just relying on the initial principal. Conversely, withdrawals will reduce the final amount.</li>
                    <li><b>Consider inflation:</b> While this calculator shows nominal growth, remember that inflation reduces the purchasing power of your future balance. Use the Inflation calculator to see the real value.</li>
                </ul>
            </div>
        </div>
        <div id="rebalancer" class="calculator-section calculator-content"> <!-- Updated ID -->
            <!-- Removed H2 Title -->
            <div class="rebalancer">
                <form id="portfolioForm">
                  <div class="calc-row"> <!-- Keep styling consistent -->
                    <label for="deposit">Deposit/Withdrawal ($):</label> <!-- Updated label -->
                    <input type="number" id="deposit" value="500" oninput="calculateRebalance()">
                    <small>(Enter negative for withdrawal)</small>
                  </div>
                  <br>
                  <div class="table-scroll-wrapper"> <!-- Added wrapper -->
                  <table id="investmentTable">
                    <thead>
                      <tr>
                        <th>Symbol</th>
                        <th>Current Value ($)</th> <!-- Updated header -->
                        <th>Target Allocation (%)</th> <!-- Updated header -->
                        <th>Rebalance Amount ($)</th> <!-- Updated header -->
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody> <!-- Removed duplicate ID -->
                      <tr>
                        <td><input type="text" name="symbol" value="VT"></td>
                        <td><input type="number" name="value" value="5000" oninput="calculateRebalance()"></td>
                        <td><input type="number" name="allocation" value="60" oninput="calculateRebalance()"></td>
                        <td class="rebalanceAmount"></td>
                        <td><button type="button" onclick="removeInvestment(this)">Remove</button></td>
                      </tr>
                      <tr>
                        <td><input type="text" name="symbol" value="BNDW"></td>
                        <td><input type="number" name="value" value="3500" oninput="calculateRebalance()"></td>
                        <td><input type="number" name="allocation" value="40" oninput="calculateRebalance()"></td>
                        <td class="rebalanceAmount"></td>
                        <td><button type="button" onclick="removeInvestment(this)">Remove</button></td>
                      </tr>
                    </tbody>
                    <tfoot> <!-- Added tfoot for summary -->
                      <tr>
                        <th colspan="5"><span class="tfoot-label">Current Balance: </span><span id="currentBalance"></span></th>
                      </tr>
                      <tr>
                        <th colspan="5"><span class="tfoot-label">Target Balance: </span><span id="targetBalance"></span></th>
                      </tr>
                    </tfoot>
                  </table>
                  </div> <!-- Closed wrapper -->
                  <button type="button" class="calculateBtn" onclick="addInvestment()" style="margin-top: 15px;">Add Investment</button> <!-- Removed inline background-color -->
                   <div class="calculator-results"> <!-- Keep results div for error message -->
                     <p id="error-message" style="color: #ff4444; font-weight: bold; margin-top: 10px;"></p>
                  </div>
                </form>
            </div>
            <p>Use this tool to rebalance your investment portfolio back to your desired target allocations. Enter your current holdings, target percentages, and any new deposit/withdrawal amount to see the suggested trades.</p>
        </div>
        <div id="inflation" class="calculator-section calculator-content"> <!-- Updated ID -->
            <!-- Removed H2 Title -->
            <div id="inflation-calculator">
                <div class="calc-row">
                    <label for="dollarField">Start Amount ($):</label>
                    <input type="number" id="dollarField" value="1000" onkeypress="return isNumberKeyInflation(event)">
                </div>
                <div class="calc-row">
                    <label for="startYearField">Start Year:</label>
                    <input type="number" id="startYearField" value="1913" placeholder="e.g., 1980" onkeypress="return isNumberKeyInflation(event)">
                    <small>(Data typically available from ~1913 onwards)</small>
                </div>
                <div class="calc-row">
                    <label for="endYearField">End Year:</label>
                    <input type="number" id="endYearField" value="2024" placeholder="e.g., 2024" onkeypress="return isNumberKeyInflation(event)">
                </div>
                <button class="calculateBtn" onclick="calculateInflation()">Calculate Inflation Adjustment</button>
                <div class="calculator-results">
                     <p id="inflation-output"></p> <!-- Unique ID -->
                </div>
            </div>
            <p>See how inflation affects the purchasing power of money over time. Enter an amount and select start/end years (based on US CPI data) to calculate its equivalent value in a different year.</p>
            <p style="margin-top: 10px;">The formula used is based on the Consumer Price Index (CPI):</p>
            <p style="text-align: center; margin: 10px 0;"> <!-- Removed fixed font-size -->
                <code style="background-color: #2a2a2a; padding: 5px 8px; border: 1px solid #444; border-radius: 3px; overflow-wrap: break-word; word-break: break-all; display: inline-block; max-width: 100%;">
                    Adjusted Amount = Start Amount * (End Year CPI / Start Year CPI)
                </code>
            </p>
            <p>Where:</p>
            <ul style="margin-top: 5px; margin-left: 30px; font-size: 0.9em;">
                <li><b>Adjusted Amount</b> = the value in the end year's dollars</li>
                <li><b>Start Amount</b> = the value in the start year's dollars</li>
                <li><b>CPI</b> = Consumer Price Index for the respective year</li>
            </ul>
        </div>
        <div id="mortgage" class="calculator-section calculator-content"> <!-- Updated ID -->
            <!-- Removed H2 Title -->
            <div id="mortgage-calculator">
                 <div class="calc-row">
                    <label for="homeValue">Home Value ($):</label>
                    <input type="number" id="homeValue" value="350000"> <!-- Added Home Value -->
                </div>
                 <div class="calc-row">
                    <label for="downPayment">Down Payment ($):</label>
                    <input type="number" id="downPayment" value="50000"> <!-- Added Down Payment -->
                </div>
                <div class="calc-row">
                    <label for="interestRate">Annual Interest Rate (%):</label>
                    <input type="number" id="interestRate" value="6.5">
                </div>
                <div class="calc-row">
                    <label for="loanTerm">Loan Term (Years):</label>
                    <input type="number" id="loanTerm" value="30">
                </div>
                 <div class="calc-row">
                    <label for="taxes">Annual Property Tax ($):</label>
                    <input type="number" id="taxes" value="4000">
                    <small>(Optional)</small>
                </div>
                 <div class="calc-row">
                    <label for="insurance">Annual Home Insurance ($):</label>
                    <input type="number" id="insurance" value="1200">
                    <small>(Optional)</small>
                </div>
                 <div class="calc-row">
                    <label for="pmi">Monthly PMI ($):</label> <!-- Assuming JS expects monthly, though label might imply rate -->
                    <input type="number" id="pmi" value="100">
                    <small>(Optional, if applicable)</small>
                </div>
                <button class="calculateBtn" onclick="calculateMortgage()">Calculate Monthly Payment</button>
                <div class="calculator-results">
                     <p id="mortgage-output"></p> <!-- Unique ID -->
                     <p id="mortgage-error" style="color: #ff4444;"></p> <!-- Unique ID -->
                </div>
            </div>
            <p>Estimate your monthly mortgage payment, including principal, interest, and optionally property taxes, home insurance, and PMI. Enter the home value, down payment, interest rate, and loan term.</p>
            <p style="margin-top: 10px;">The core formula for the monthly principal and interest payment (M) is:</p>
            <p style="text-align: center; margin: 10px 0; line-height: 1.4;"> <!-- Removed fixed font-size -->
                <code style="background-color: #2a2a2a; padding: 5px 8px; border: 1px solid #444; border-radius: 3px; overflow-wrap: break-word; word-break: break-all; display: inline-block; max-width: 100%;">
                    M = P [ i(1 + i)<sup>n</sup> ] / [ (1 + i)<sup>n</sup> – 1]
                </code>
            </p>
            <p>Where:</p>
            <ul style="margin-top: 5px; margin-left: 30px; font-size: 0.9em;">
                <li><b>M</b> = Total monthly mortgage payment (Principal & Interest)</li>
                <li><b>P</b> = Principal loan amount (Home Value - Down Payment)</li>
                <li><b>i</b> = Monthly interest rate (Annual Rate / 12)</li>
                <li><b>n</b> = Total number of payments (Loan Term in years * 12)</li>
            </ul>
            <p style="font-size: 0.9em; margin-top: 5px;">The calculator adds estimated monthly taxes, insurance, and PMI (if provided) to this amount for the total estimated payment.</p>
            <p style="font-size: 0.9em; margin-top: 10px;"><b>Helpful Tips:</b></p>
            <ul style="margin-top: 5px; margin-left: 30px; font-size: 0.9em;">
                <li><b>Interest Rate Impact:</b> Small changes in the interest rate can drastically alter your monthly payment and the total interest paid over the life of the loan.</li>
                <li><b>Loan Term Trade-offs:</b> A shorter loan term (e.g., 15 years) means higher monthly payments but significantly less total interest paid. A longer term (e.g., 30 years) lowers the monthly payment but increases the total interest cost substantially.</li>
                <li><b>Down Payment Power:</b> A larger down payment reduces the principal loan amount (P), lowering your monthly payment and potentially helping you avoid PMI if you reach 20% equity.</li>
                <li><b>Beyond P&I:</b> Remember that the total payment (PITI + PMI) is often much higher than just the principal and interest calculated by the core formula. Factor in taxes, insurance, and potential PMI for a realistic estimate.</li>
                <li><b>Extra Payments:</b> Making additional payments towards the principal can shorten your loan term and save considerable interest, but ensure your lender applies extra payments directly to principal.</li>
            </ul>
        </div>

    </div>

    <!-- Include jQuery -->
    <script src="js/jquery-3.6.0.min.js"></script>

    <!-- Calculator Switching Logic -->
    <script>
        $(document).ready(function() {
            // --- Custom Dropdown Logic (Adapted from crypto.html) ---
            const calculatorMenuTrigger = $('#calculator-menu-trigger');
            const calculatorMenu = $('#calculator-menu');
            const calculatorOptions = $('#calculator-menu .calculator-option');
            const calculatorSections = $('.calculator-section'); // Use .calculator-section

            // Toggle dropdown visibility
            calculatorMenuTrigger.on('click', function(e) {
                e.stopPropagation(); // Prevent click from immediately closing menu
                calculatorMenu.toggleClass('active');
            });

            // --- Function to show a specific calculator section ---
            function showCalculatorSection(targetId, updateHistory = true) {
                // Remove # if present
                const cleanTargetId = targetId.startsWith('#') ? targetId.substring(1) : targetId;

                const targetSection = $('#' + cleanTargetId);
                const targetOption = calculatorOptions.filter(`[data-target="${cleanTargetId}"]`);

                if (!targetSection.length) {
                     console.warn(`Target section #${cleanTargetId} not found. Defaulting.`);
                     // Default to compound if target is invalid
                     showCalculatorSection('compound', false); // Call recursively with default, don't update history
                     return;
                }

                // Update trigger button text using data-display
                let buttonText = "Select Calculator"; // Fallback text
                if (targetOption.length && targetOption.data('display')) {
                     buttonText = targetOption.data('display');
                } else {
                     // If targetOption not found or missing data-display, use default
                     const defaultOption = calculatorOptions.filter('[data-target="compound"]');
                     if (defaultOption.length && defaultOption.data('display')) {
                         buttonText = defaultOption.data('display');
                     }
                }
                calculatorMenuTrigger.text(buttonText); // Set the button text


                // Hide other sections and show the target
                const currentActiveSection = $('.calculator-section.active'); // Target calculator sections
                if (currentActiveSection.attr('id') !== cleanTargetId) {
                   currentActiveSection.removeClass('active');
                   targetSection.addClass('active');
                }

                // Update active state on options
                calculatorOptions.removeClass('active-selector');
                if(targetOption.length) {
                    targetOption.addClass('active-selector');
                } else {
                    // Highlight default option if target option wasn't found
                    calculatorOptions.filter('[data-target="compound"]').addClass('active-selector');
                }


                // Update URL hash if requested and different
                const currentHash = window.location.hash;
                const newHash = '#' + cleanTargetId;
                if (updateHistory && currentHash !== newHash) {
                    if (history.pushState) {
                        history.pushState(null, null, newHash);
                    } else {
                        window.location.hash = newHash; // Fallback
                    }
                }
            }

            // Handle option selection from dropdown
            calculatorOptions.on('click', function() {
                const targetId = $(this).data('target');
                calculatorMenu.removeClass('active'); // Hide menu
                showCalculatorSection(targetId, true); // Show section and update history
            });

            // Close dropdown if clicking outside
            $(document).on('click', function(e) {
                if (!calculatorMenu.is(e.target) && calculatorMenu.has(e.target).length === 0 && !calculatorMenuTrigger.is(e.target)) {
                    calculatorMenu.removeClass('active');
                }
            });

            // --- Handle Hash on Page Load and Back/Forward ---
            function handleCalcHashChange() {
                const hash = window.location.hash;
                const validCalcTargets = ['compound', 'rebalancer', 'inflation', 'mortgage']; // Keep this updated
                let targetId = 'compound'; // Default

                if (hash && hash.length > 1) {
                    const potentialTarget = hash.substring(1);
                    if (validCalcTargets.includes(potentialTarget)) {
                        targetId = potentialTarget;
                    } else {
                         console.warn(`Invalid calculator hash detected: ${hash}. Defaulting to compound.`);
                    }
                }
                showCalculatorSection(targetId, false); // Show section without updating history again
            }

            // Listen for hash changes (back/forward buttons)
            $(window).on('hashchange', handleCalcHashChange);

            // Initial page load check
            handleCalcHashChange();

            // --- Initialize Calculators (assuming functions exist) ---
            // No init function needed for calculator.js as it uses onclick
            // No init function needed for rebalancer.js as it uses DOMContentLoaded and oninput
            // No init function needed for inflation_calculator.js as it uses onclick
            // No init function needed for mortgage.js as it uses onclick
        });
    </script>

    <!-- Hamburger Menu Script -->
    <script>
        const hamburgerBtn = document.getElementById('hamburger-btn');
        const navLinks = document.getElementById('nav-links');

        hamburgerBtn.addEventListener('click', () => {
            navLinks.classList.toggle('active');
            // Optional: Toggle ARIA attribute for accessibility
            const isExpanded = navLinks.classList.contains('active');
            hamburgerBtn.setAttribute('aria-expanded', isExpanded);
        });
    </script>

    <!-- Include Chart.js library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Load Individual Calculator Scripts -->
    <script src="js/calculator.js"></script>
    <script src="js/inflation_calculator.js"></script>
    <script src="js/mortgage.js"></script>
    <script src="js/rebalancer.js"></script>
    <!-- Advertisement Script -->
    <script src="js/advertisement.js"></script>

</body>
</html>