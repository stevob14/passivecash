<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Live Bitcoin (BTC) and Ethereum (ETH) price tickers and historical charts with linear regression analysis from PassiveCash.xyz.">
    <title>Crypto Tickers & Charts - PassiveCash.xyz</title>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q203YEXP0D"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-Q203YEXP0D');
    </script>
    <style>
        body {
            font-family: 'Courier New', Courier, monospace; /* Monospace font */
            margin: 0;
            padding: 0;
            background-color: #0a0a0a; /* Dark background */
            color: #e0e0e0; /* Light grey text */
            line-height: 1.6;
        }
        .navbar {
            background-color: #1a1a1a; /* Darker navbar */
            padding: 10px 0;
            color: #00ff00; /* Green text */
            border-bottom: 1px solid #00ff00; /* Green border */
            position: relative; /* Needed for absolute positioning of mobile menu */
        }
        .navbar .container {
             display: flex;
             justify-content: space-between;
             align-items: center;
             max-width: 960px; /* Limit navbar content width */
             margin: auto; /* Center navbar content */
             padding: 0 15px; /* Padding for navbar content */
        }
         .navbar .logo {
             color: #00ff00; /* Green logo */
             text-decoration: none;
             font-size: 1.5em;
             font-weight: bold;
             z-index: 10; /* Ensure logo is above mobile menu */
         }
        /* Hamburger Button Styles */
        #hamburger-btn {
            display: none; /* Hidden by default */
            background: none;
            border: none;
            color: #00ff00;
            font-size: 2em;
            cursor: pointer;
            padding: 0 5px;
            z-index: 10; /* Ensure button is above mobile menu */
        }
        #hamburger-btn .bar {
            display: block;
            width: 25px;
            height: 3px;
            margin: 5px auto;
            background-color: #00ff00;
            transition: all 0.3s ease-in-out;
        }

        /* Desktop Navigation Styles */
        .navbar ul#nav-links {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex; /* Display links horizontally by default */
        }
        .navbar ul#nav-links li {
            margin-left: 20px;
        }
        .navbar ul#nav-links li a {
            color: #00ff00; /* Green links */
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s, color 0.3s; /* Smooth transition */
        }
        .navbar ul#nav-links li a:hover,
        .navbar ul#nav-links li a.active {
            background-color: #00ff00; /* Green background on hover/active */
            color: #0a0a0a; /* Dark text on hover/active */
        }
        .container { /* Container for navbar content */
            max-width: 960px;
            margin: auto;
            padding: 0 15px; /* Padding for navbar content on smaller screens */
            /* Remove background/shadow/border-radius from navbar container */
        }

         /* Advertisement Bar Styles */
         #advertisement {
             background-color: #333; /* Dark grey background */
             color: #ffa500; /* Orange text color (default, overridden by link style) */
             padding: 8px 0;
             text-align: center;
             font-size: 0.9em;
             border-bottom: 1px solid #555;
         }
         #advertisement a {
             color: #ffa500 !important; /* Ensure link color overrides default */
             text-decoration: underline;
         }
         #advertisement a:hover {
             color: #ffc966 !important; /* Lighter orange on hover */
         }

         .content-container { /* Container for page content */
             max-width: 960px;
             margin: 20px auto;
             background: #1f1f1f; /* Slightly lighter dark background */
             padding: 30px;
             border-radius: 0px; /* Sharp corners */
             border: 1px solid #00ff00; /* Green border */
             box-shadow: 0 0 10px rgba(0, 255, 0, 0.3); /* Green glow effect */
             color: #e0e0e0; /* Ensure text color is light */
         }
        h1 {
            color: #00ff00; /* Green headings */
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 0 0 5px #00ff00; /* Green text glow */
        }
         h2 {
             color: #00ff00; /* Green headings */
             border-bottom: 1px solid #00ff00; /* Green border */
             padding-bottom: 5px;
             margin-top: 40px;
             text-shadow: 0 0 3px #00ff00; /* Green text glow */
         }
         /* Crypto Specific Styles */
         .crypto-section {
             margin-bottom: 40px;
             display: none; /* Hide crypto sections by default */
         }
         .crypto-section.active {
             display: block; /* Show the active crypto section */
         }
         /* --- Custom Crypto Selector Dropdown --- */
         #crypto-selector-container {
             margin-bottom: 30px;
             text-align: left; /* Align container content left */
             position: relative; /* Needed for absolute positioning of menu */
         }
         #crypto-menu-trigger { /* Style the trigger button */
             display: block; /* Make trigger full width */
             width: 100%; /* Explicitly set full width */
             text-align: center; /* Center text within the button */
             margin-bottom: 5px;
             /* Base button styles */
             background-color: #1a1a1a;
             color: #00ff00;
             padding: 10px 20px;
             border: 1px solid #00ff00;
             border-radius: 0px;
             cursor: pointer;
             font-size: 1em;
             font-weight: bold;
             transition: background-color 0.3s, color 0.3s;
             font-family: 'Courier New', Courier, monospace;
             position: relative; /* For pseudo-element arrow */
             padding-right: 30px; /* Make space for arrow */
         }
         #crypto-menu-trigger::after { /* Dropdown arrow */
             content: '';
             position: absolute;
             right: 10px;
             top: 50%;
             transform: translateY(-50%);
             border-left: 5px solid transparent;
             border-right: 5px solid transparent;
             border-top: 5px solid #00ff00; /* Green arrow */
             pointer-events: none; /* Prevent arrow from interfering with clicks */
         }
         #crypto-menu-trigger:hover {
             background-color: #00ff00;
             color: #0a0a0a;
         }
         #crypto-menu { /* Style the dropdown container */
             display: none; /* Hide menu by default */
             position: absolute;
             top: 100%; /* Position below trigger */
             left: 0; /* Align menu to the left */
             /* transform: translateX(-50%); Removed centering transform */
             width: 100%; /* Make menu full width */
             background-color: #1a1a1a; /* Dark background for dropdown */
             border: 1px solid #00ff00; /* Green border */
             z-index: 50; /* Ensure it's above other content */
             padding: 5px 0;
             box-shadow: 0 4px 8px rgba(0, 255, 0, 0.2); /* Subtle green shadow */
         }
         #crypto-menu.active {
             display: block; /* Show menu when active */
         }
         #crypto-menu .crypto-option { /* Style the option buttons */
             display: block;
             width: 100%;
             margin: 0;
             padding: 10px 15px;
             text-align: left;
             border: none;
             border-bottom: 1px solid #333; /* Separator */
             border-radius: 0;
             font-size: 1em;
             /* Base button styles */
             background-color: #1a1a1a;
             color: #00ff00;
             cursor: pointer;
             transition: background-color 0.3s, color 0.3s;
             font-family: 'Courier New', Courier, monospace;
             font-weight: bold;
         }
         #crypto-menu .crypto-option:last-child {
             border-bottom: none;
         }
         #crypto-menu .crypto-option:hover {
             background-color: #00ff00;
             color: #0a0a0a;
         }
         /* Style for the selected option (optional, if needed) */
         #crypto-menu .crypto-option.active-selector {
             background-color: #00ff00;
             color: #0a0a0a;
             cursor: default;
         }
         .ticker {
             font-size: 1.2em;
             font-weight: bold;
             margin-bottom: 15px;
             padding: 10px;
             background-color: #2a2a2a; /* Dark background */
             border-radius: 0px; /* Sharp corners */
             text-align: center;
             border: 1px dashed #444; /* Dashed dark grey border */
             color: #e0e0e0; /* Light text */
         }
         .ticker span { /* Style for the price */
            color: #00ff00; /* Green price */
            margin-left: 10px;
            font-weight: bold;
            /* text-shadow applied below */
        }
        /* Style for the actual price spans */
        .BtcPrice, .EthPrice, .SolPrice {
            color: #00ff00; /* Green price */
            font-weight: bold;
            font-size: 1.2em; /* Match ticker style */
            display: block; /* Allow margin/centering */
            /* text-align: center; Removed centering */
            margin-bottom: 15px; /* Space below price */
            text-shadow: 0 0 3px #00ff00; /* Add glow effect */
        }
        .chart-container {
            width: 100%;
            height: 400px; /* Adjust height as needed */
            margin-top: 10px;
            border: 1px solid #444; /* Dark grey border for chart */
             background-color: #111; /* Dark background for chart area */
         }

        /* Responsive Navbar */
        @media (max-width: 768px) {
             .navbar .container {
                 /* flex-direction: column; Removed */
                 /* align-items: flex-start; Removed */
                 position: relative; /* Needed for absolute positioning of menu */
             }
             #hamburger-btn {
                 display: block; /* Show hamburger */
             }
             .navbar ul#nav-links {
                 display: none; /* Hide links by default */
                 flex-direction: column;
                 width: 100%;
                 position: absolute;
                 top: 100%; /* Position below navbar */
                 left: 0;
                 background-color: #1a1a1a; /* Match navbar background */
                 padding: 10px 0; /* Add some padding */
                 border-top: 1px solid #00ff00; /* Separator */
                 z-index: 100; /* Ensure menu is above content */
             }
             .navbar ul#nav-links.active {
                 display: flex; /* Show links when active */
             }
             .navbar ul#nav-links li {
                 margin-left: 0;
                 margin-bottom: 0; /* Remove bottom margin */
                 text-align: center;
                 width: 100%; /* Make list items full width */
             }
             .navbar ul#nav-links li a {
                 display: block; /* Make links take full width */
                 padding: 10px 0; /* Adjust padding */
                 border-bottom: 1px solid #333; /* Separator between links */
             }
             .navbar ul#nav-links li:last-child a {
                 border-bottom: none; /* Remove border from last link */
             }
        }
        @media (max-width: 600px) {
             .content-container {
                 padding: 15px;
             }
             h1 {
                 font-size: 1.8em;
             }
             h2 {
                 font-size: 1.3em;
             }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
             <a href="index.html" class="logo">PassiveCash.xyz</a>
             <!-- Hamburger Button -->
             <button id="hamburger-btn" aria-label="Toggle Navigation Menu" aria-expanded="false">
                 <span class="bar"></span>
                 <span class="bar"></span>
                 <span class="bar"></span>
             </button>
             <!-- Navigation Links -->
            <ul id="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="calculators.html">Calculators</a></li>
                <li><a href="crypto.html" class="active">Crypto</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="disclaimer.html">Disclaimer</a></li>
            </ul>
        </div>
    </nav>

    <!-- Advertisement Bar -->
    <div id="advertisement"></div>

    <div class="content-container">
        <div id="crypto-selector-container">
            <button id="crypto-menu-trigger">Bitcoin (BTC)</button> <!-- Trigger Button -->
            <div id="crypto-menu"> <!-- Dropdown Menu -->
                <button class="crypto-option" data-target="btc-section" data-display="Bitcoin (BTC)">Bitcoin (BTC)</button>
                <button class="crypto-option" data-target="eth-section" data-display="Ethereum (ETH)">Ethereum (ETH)</button>
                <button class="crypto-option" data-target="sol-section" data-display="Solana (SOL)">Solana (SOL)</button>
            </div>
        </div>

<div id="btc-section" class="crypto-section crypto-content active">
    <!-- Removed H2 Title -->
    <span class="BtcPrice"></span> <!-- Use unique class -->
    <p>Bitcoin is the first decentralized cryptocurrency that consists of peer-to-peer transactions that are verified and recorded in a public blockchain. What is unique about Bitcoin is the ability to act as a currency outside the control of any person, group, or entity. Get free Bitcoin worth $20 by signing up at <a href="https://coinbase.com/join/MG2TWZF">Coinbase-Referral</a>.</p>
    <div id="chart" class="chart-container"></div> <!-- Target for btc_chart.js -->
</div>

<div id="eth-section" class="crypto-section crypto-content">
    <!-- Removed H2 Title -->
    <span class="EthPrice"></span> <!-- Use unique class -->
    <p>Ethereum is the first decentralized blockchain network that can run smart contracts and is powered by the ETH cryptocurrency. Smart contracts are applications that run exactly as programmed without any chance of censorship, fraud or third-party interference. What makes this unique is the ability of developers to build custom smart contracts for various applications using the Ethereum network. For example, <a href="/index.html#crypto-interest">DeFi</a> applications built using the Ethereum network.</p>
    <div id="chart-eth" class="chart-container"></div> <!-- Use unique ID -->
</div>

<div id="sol-section" class="crypto-section crypto-content">
    <!-- Placeholder Title/Content -->
    <span class="SolPrice"></span> <!-- Use unique class -->
    <p>Solana is a high-performance blockchain supporting builders around the world creating crypto apps that scale today. It is known for its speed and low transaction costs.</p>
    <div id="chart-sol" class="chart-container"></div> <!-- Use unique ID -->
</div>

    </div>

    <!-- Include jQuery and Highstock (for charts) -->
    <script src="js/jquery-3.6.0.min.js"></script>
    <script src="js/highstock.js"></script>
    <!-- Include Crypto JS files -->
    <script src="js/linear_regression.js"></script> <!-- Uncommented and moved up -->
    <script src="js/ticker.js"></script> <!-- Unified ticker script -->
    <script src="js/chart.js"></script>  <!-- Unified chart script -->
    <!-- Removed old btc/eth specific ticker and chart scripts -->

    <script>
        // Define baseTitle and updatePageTitle globally BEFORE document.ready
        const baseTitle = document.title; // Store base title globally

        // --- Function to update page title --- (Now Global)
        // Accepts cryptoType directly
        function updatePageTitle(cryptoType, price) {
            // console.log(`updatePageTitle called: cryptoType=${cryptoType}, price=${price}, baseTitle=${baseTitle}`); // DEBUG LOG removed
            if (price && cryptoType) {
                const formattedPrice = parseFloat(price).toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                const newTitle = `${cryptoType.toUpperCase()} ${formattedPrice} - PassiveCash.xyz`;
                // console.log(`Setting title to: ${newTitle}`); // DEBUG LOG removed
                document.title = newTitle;
            } else {
                // console.log(`Resetting title to baseTitle: ${baseTitle}`); // DEBUG LOG removed
                document.title = baseTitle; // Reset on error or missing info
            }
        }

        // Placeholder for potential page-specific initialization if needed
        $(document).ready(function() {
            console.log("Crypto page loaded.");
            let activePriceIntervalId = null; // Variable to hold the active interval ID
            // baseTitle is now global
            // --- Function to start/switch the active price ticker ---
            function startTicker(cryptoType) {
                console.log("Starting ticker for:", cryptoType); // Debug log
                // Clear any existing interval
                if (activePriceIntervalId) {
                    clearInterval(activePriceIntervalId);
                    activePriceIntervalId = null;
                    console.log("Cleared previous interval"); // Debug log
                }

                // Determine the correct price element selector based on cryptoType
                let priceSelector;
                if (cryptoType === 'btc') {
                    priceSelector = '.BtcPrice';
                } else if (cryptoType === 'eth') {
                    priceSelector = '.EthPrice';
                } else if (cryptoType === 'sol') {
                    priceSelector = '.SolPrice';
                } else {
                     console.error("Cannot determine priceSelector in startTicker for:", cryptoType);
                     return; // Don't proceed if type is unknown
                }

                // Use the unified ticker function, passing the selector
                get_crypto_price(cryptoType, priceSelector); // Call once immediately
                activePriceIntervalId = setInterval(() => get_crypto_price(cryptoType, priceSelector), 1000); // Set interval
                console.log(`Started ${cryptoType.toUpperCase()} interval:`, activePriceIntervalId); // Debug log
            }

            // --- Custom Dropdown Logic ---
            const cryptoMenuTrigger = $('#crypto-menu-trigger');
            const cryptoMenu = $('#crypto-menu');
            const cryptoOptions = $('#crypto-menu .crypto-option'); // Buttons within the menu
            const cryptoSections = $('.crypto-content'); // The content sections (btc-section, eth-section)

            // Toggle dropdown visibility
            cryptoMenuTrigger.on('click', function(e) {
                e.stopPropagation(); // Prevent click from immediately closing menu
                cryptoMenu.toggleClass('active');
            });

            // --- Function to show a specific section ---
            function showSection(targetId, updateHistory = true) {
                const targetSection = $('#' + targetId);
                const targetOption = cryptoOptions.filter(`[data-target="${targetId}"]`);

                if (!targetSection.length) { return; } // Exit if target doesn't exist

                // Derive cryptoType from targetId (e.g., "sol-section" -> "sol")
                const cryptoType = targetId.replace('-section', '');
                // Define valid types for safety check
                const validTypes = ['btc', 'eth', 'sol'];
                if (!validTypes.includes(cryptoType)) {
                     console.error("Could not derive valid cryptoType from targetId:", targetId);
                     return;
                }

                // Derive chartContainerId (special case for btc)
                const chartContainerId = (cryptoType === 'btc') ? 'chart' : `chart-${cryptoType}`;

                // Update trigger button text
                if (targetOption.length && cryptoMenuTrigger.text() !== targetOption.data('display')) {
                    cryptoMenuTrigger.text(targetOption.data('display'));
                }

                // Hide other sections and show the target
                const currentActiveSection = $('.crypto-content.active');
                if (currentActiveSection.attr('id') !== targetId) {
                   currentActiveSection.removeClass('active');
                   targetSection.addClass('active');
                }

                // Initialize chart only if it hasn't been initialized yet
                // We use a data attribute on the section to track initialization
                if (targetSection.data('chart-initialized') !== true) {
                    console.log(`Initializing chart for ${cryptoType} in #${chartContainerId}`);
                    // Ensure the container exists before creating chart
                    if ($(`#${chartContainerId}`).length) {
                         create_crypto_chart(cryptoType, chartContainerId);
                         targetSection.data('chart-initialized', true); // Mark as initialized
                    } else {
                         console.error(`Chart container #${chartContainerId} not found!`);
                    }
                } else {
                     console.log(`Chart for ${cryptoType} already initialized.`);
                     // Optional: Reflow existing chart if needed after being hidden/shown
                     // This requires finding the specific chart instance. Highcharts stores them
                     // in Highcharts.charts array, but finding the right one can be tricky.
                     // A simpler way might be to store the chart instance on the element itself.
                     // Or, if reflow isn't strictly necessary, just skip it.
                     // Example using Highcharts.charts (less reliable if charts are destroyed/recreated):
                     // const chartInstance = Highcharts.charts.find(c => c && c.renderTo.id === chartContainerId);
                     // if (chartInstance) {
                     //     chartInstance.reflow();
                     // }
                }

                // Always start/restart the ticker for the selected section
                startTicker(cryptoType);

                // Update URL hash if requested and different
                const currentHash = window.location.hash;
                const newHash = '#' + cryptoType;
                if (updateHistory && currentHash !== newHash) {
                    if (history.pushState) {
                        history.pushState(null, null, newHash);
                    } else {
                        window.location.hash = newHash; // Fallback
                    }
                }
            }

            // Handle option selection from dropdown
            cryptoOptions.on('click', function() {
                const targetId = $(this).data('target');
                cryptoMenu.removeClass('active'); // Hide menu
                showSection(targetId, true); // Show section and update history
            });

            // Close dropdown if clicking outside
            $(document).on('click', function(e) {
                if (!cryptoMenu.is(e.target) && cryptoMenu.has(e.target).length === 0 && !cryptoMenuTrigger.is(e.target)) {
                    cryptoMenu.removeClass('active');
                }
            });

            // --- Handle Hash on Page Load and Back/Forward ---
            function handleHashChange() {
                const hash = window.location.hash; // e.g., "#sol"
                const validTypes = ['btc', 'eth', 'sol']; // Keep this list updated
                let cryptoType = 'btc'; // Default

                if (hash && hash.length > 1) {
                    const potentialType = hash.substring(1); // Remove '#' -> "sol"
                    if (validTypes.includes(potentialType)) {
                        cryptoType = potentialType;
                    } else {
                         console.warn(`Invalid hash detected: ${hash}. Defaulting to BTC.`);
                    }
                }

                // Construct targetId directly
                const targetId = `${cryptoType}-section`;

                showSection(targetId, false); // Show section without updating history again
            }

            // Listen for hash changes (back/forward buttons)
            $(window).on('hashchange', handleHashChange);

            // Initial page load check
            handleHashChange();

            // Chart initialization would happen here or be triggered by the ticker scripts if needed
            // let btcChart, ethChart; // Define chart variables if needed for reflow
        });
    </script>

    <!-- Hamburger Menu Script -->
    <script>
        const hamburgerBtn = document.getElementById('hamburger-btn');
        const navLinks = document.getElementById('nav-links');

        hamburgerBtn.addEventListener('click', () => {
            navLinks.classList.toggle('active');
            // Optional: Toggle ARIA attribute for accessibility
            const isExpanded = navLinks.classList.contains('active');
            hamburgerBtn.setAttribute('aria-expanded', isExpanded);
        });
    </script>

    <!-- Advertisement Script -->
    <script src="js/advertisement.js"></script>

</body>
</html>
